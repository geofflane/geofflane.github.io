---
layout: post
status: publish
published: true
title: Wordpress Code Formatting
author:
  display_name: Geoff Lane
  login: admin
  email: geoff@zorched.net
  url: http://www.zorched.net
author_login: admin
author_email: geoff@zorched.net
author_url: http://www.zorched.net
excerpt: "I finally got tired of dealing with reformatting that Wordpress does in
  its attempt to be \"user friendly\". In general it does the right thing, but when
  you deal with code snipits inside &lt;code&gt; tags a lot it can quickly become
  a problem.\r\n\r\nIn just a few easy steps, the problems can be solved."
wordpress_id: 44
wordpress_url: http://www.zorched.net/2006/09/25/wordpress-code-formatting/
date: '2006-09-25 16:55:37 -0400'
date_gmt: '2006-09-25 22:55:37 -0400'
categories:
- Life
- Web
tags:
- WordPress
- code formatting
- blogging
comments:
- id: 379
  author: Brennan Stehling
  author_email: offwhite@gmail.com
  author_url: http://brennan.offwhite.net/blog/
  date: '2006-09-26 15:21:45 -0400'
  date_gmt: '2006-09-26 21:21:45 -0400'
  content: "For my Wordpress blog I simply turned off the wysiwyg editor and now hack
    the code as I like.\r\n\r\nNow to make it smart enough to do syntax highlighting
    would be extremely useful.  One approach would be to place your code into a code
    block with a class attribute denoting the language.  Then I would active some
    Javascript to run through the code elements and highlight the keywords for the
    respective languages.  That would be an excellent addition to one of the major
    Javascript frameworks.  And then auto-linking the import/using statements
    to the official online documentation would be even better."
- id: 380
  author: Geoff Lane
  author_email: geoff@zorched.net
  author_url: http://www.zorched.net
  date: '2006-09-26 17:13:24 -0400'
  date_gmt: '2006-09-26 23:13:24 -0400'
  content: "That's an interesting idea. You could import other files based on the
    class name to use as your template for syntax highlighting.\r\n\r\nI'm gonna start
    working on it! :)"
- id: 381
  author: Zorched / One Line Fix &raquo; Javascript Code Formatting
  author_email: ''
  author_url: http://www.zorched.net/2006/09/26/javascript-code-formatting/
  date: '2006-09-26 18:24:10 -0400'
  date_gmt: '2006-09-27 00:24:10 -0400'
  content: "[...] Wordpress Code Formatting [...]"
- id: 431
  author: Brennan&#8217;s Blog &raquo; Blog Archive &raquo; Colorizing Code in Wordpress
  author_email: ''
  author_url: http://brennan.offwhite.net/blog/2006/10/01/colorizing-code-in-wordpress/
  date: '2006-10-01 20:59:03 -0400'
  date_gmt: '2006-10-02 02:59:03 -0400'
  content: "[...] Last week I had an exchange with Geoff over code formating and suggested
    it could be done with Javascript. We both happen to run Wordpress for our blogs
    and I have also been looking for a way to insert stylized code into blog entries,
    so I helped him to put together a solution. Pretty soon we had a solution. Initially
    I suggested that it could be done with a bit of Javascript. He considered creating
    his own new script, but like any pragmatic developer, he looked and found an existing
    solution called dp.SyntaxHighlighter instead of starting from scratch. [...]"
- id: 6787
  author: under construction &raquo; Blog Archive &raquo; Getting My Wordpress Blog
    Into ColdFusion Using RSS
  author_email: ''
  author_url: http://samedwar.setupmyblog.com/?p=8
  date: '2007-02-06 19:37:04 -0500'
  date_gmt: '2007-02-07 01:37:04 -0500'
  content: "[...] And here&#8217;s where I need my first wordpress plugin, code-formatting
    wordpress blogs thanks to Zorched. [...]"
- id: 10837
  author: Naveen
  author_email: nawingee@gmail.com
  author_url: ''
  date: '2007-07-04 01:11:55 -0400'
  date_gmt: '2007-07-04 07:11:55 -0400'
  content: "Gr8 work :)\r\n\r\nI am PHP Programmer. I have a requirement from my client
    that needs to be fixed.\r\nHe have a wordpress-mu (1.2.1) intalles and there are
    several blog sites are running under it. This is his feedback,\r\n&acirc;&euro;\x9D
    We&acirc;&euro;&trade;ve had issues posting HTML into wordpress. Wordpress wants
    to format the html after we post an article. Even if we only use the &acirc;&euro;&oelig;Code&acirc;&euro;\x9D
    tab, the wordpress system will try to format what was pasted in. Here are some
    examples of the formatting:\r\nformats out javascript tags\r\nadds after each
    carriage return\r\nchanges &acirc;&euro;&rdquo; to &acirc;&euro;&ldquo;\r\n\r\nPlease
    look into creating a plugin that will bypass *all* the formatting when we post
    an article through the Code tab.&acirc;&euro;\x9D\r\n\r\nPlease suggest on this.\r\n\r\nThanks\r\nNaveen"
- id: 10838
  author: Geoff Lane
  author_email: geoff@zorched.net
  author_url: http://www.zorched.net
  date: '2007-07-04 08:57:21 -0400'
  date_gmt: '2007-07-04 14:57:21 -0400'
  content: "Nauveen,\r\nCheck out the link in the article to the <a href=\"http://www.coffee2code.com/archives/2005/03/29/plugin-preserve-code-formatting/\"
    rel=\"nofollow\">Preserve Code Formatting</a> plugin."
- id: 10860
  author: fluxcapacity &raquo; Blog Archive &raquo; One solution to Wordpress code-snippet
    formatting problems
  author_email: ''
  author_url: http://fluxcapacity.net/2007/07/22/one-solution-to-wordpress-code-snippet-formatting-problems/
  date: '2007-07-22 21:11:41 -0400'
  date_gmt: '2007-07-23 03:11:41 -0400'
  content: "[...] bloggers have posted hacks to the Wordpress editor into being more
    friendly.&Acirc;&nbsp; Other people have [...]"
- id: 11134
  author: Ryan
  author_email: ryanhellyer@hotmail.com
  author_url: http://ryanhellyer.net/
  date: '2008-01-19 03:49:41 -0500'
  date_gmt: '2008-01-19 09:49:41 -0500'
  content: Thanks, that did the job perfectly :)
- id: 18368
  author: WordPress Plugins That Help You Write Code &laquo; Lorelle on WordPress
  author_email: ''
  author_url: http://lorelle.wordpress.com/2007/02/23/wordpress-plugins-that-help-you-write-code/
  date: '2013-06-10 22:22:30 -0400'
  date_gmt: '2013-06-11 04:22:30 -0400'
  content: "[...] Zorched &#8211; WordPress Code Formatting [...]"
---
<p>I finally got tired of dealing with reformatting that Wordpress does in its attempt to be "user friendly". In general it does the right thing, but when you deal with code snipits inside <code> tags a lot it can quickly become a problem.</p>
<p>I wanted to accomplish two things</p>
<ol>
<li>Have whitespace matter</li>
<li>Not have Wordpress add extra linebreaks or evaluate my >s as HTML</li><br />
</ol></p>
<h3>1. Is easily done with CSS</h3><br />
<code><br />
code {<br />
    white-space: pre;<br />
}<br />
</code></p>
<p>This CSS will render the text including showing the spaces and line-breaks however they are in the source. This is just the right things for code.</p>
<h3>2. Getting Wordpress to not muck with code blocks</h3><br />
This on the other hand requires coding a solution. Luckily someone has done the hard work for us. There is an existing plugin called <a href="http://www.coffee2code.com/archives/2005/03/29/plugin-preserve-code-formatting/">Preserve Code Formatting</a> that handles this. Basically it looks through the HTML source of a posting and looks for <code> and
<pre> blocks. When it finds those blocks it removes all of the extra Wordpress formatting and handles escaping HTML entity characters.</p>
<p>The other thing I was running into was that Wordpress was "closing" things that looked like HTML. I ran into this when I was writing code snipits that contained <a href="http://java.sun.com/j2se/1.5.0/docs/guide/language/generics.html">Generics</a> syntax.</p>
<p>I tracked that down to a writing setting in Wordpress. Under Options -> Writing there is a checkbox that says: "WordPress should correct invalidly nested XHTML automatically". When this option is enabled, Wordpress will erroneously see certain things as HTML markup and try to create closing tags.</p>
<p>With this option selected I would get:<br />
<code><br />
List<br />
<address> addresses;<br />
</address><br />
</code></p>
<p>Instead of the correct output I would get when I unselected the option:<br />
<code><br />
List<Address> addresses;<br />
</code></p>
<p>With the plugin in place, a bit of CSS and turning off one option, I can now copy-and-paste code snipits into Wordpress and not have to deal with formatting.</p>
<p>Next step...syntax highlighting.</p>
<p><strong><em>Update</em></strong>:<br />
The other thing that I found in the functions-formatting.php file there is a method called 'wpautop'. This method has a call to remove breaks from
<pre> tags. So I copied the line and changed it to do the same thing to <code> tags.</p>
<p><code><br />
$pee = preg_replace('!(<code.*?>)(.*?)</ code>!ise', " stripslashes('$1') . stripslashes(clean_pre('$2'))  . '</ code>' ", $pee);<br />
</code></p>
